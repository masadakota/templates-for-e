<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>マニュアル</title>
    <link rel="stylesheet" href="../styles/bundle.css" />
    <link rel="stylesheet" href="./style.css" />
  </head>

  <body>
    <div class="sticky-header">
      <div
        class="flex flex-col gap-1"
        style="width: 500px; max-width: 100%; margin: 0 auto; padding: 8px 12px"
      >
        <div class="flex justify-between items-center gap-2">
          <!-- オペレーター名 -->
          <input
            type="text"
            style="width: 120px"
            id="operator-name-input"
            class="small-placeholder"
            placeholder="オペレーター名"
          />

          <!-- Search UI -->
          <div class="relative flex-1">
            <input
              type="text"
              id="search-input"
              class="search-input"
              placeholder="検索"
              autocomplete="off"
              aria-label="検索"
            />
            <button id="clear-btn" class="clear-btn" aria-label="検索をクリア">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M18 6L6 18M6 6L18 18"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
          </div>

          <a
            id="help-link"
            href="./help.html"
            class="text-sm"
            style="display: none"
            target="_blank"
            >管理者用ドキュメント</a
          >

          <!-- 設定 -->
          <!-- <button
            class="btn"
            style="
              border: none;
              font-weight: normal;
              color: var(--muted-foreground);
            "
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#collapseExample"
            aria-expanded="false"
            aria-controls="collapseExample"
          >
            設定
          </button> -->

          <button
            id="settings-toggle"
            class="settings-icon-btn"
            title="設定"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#collapseExample"
            aria-expanded="false"
            aria-controls="collapseExample"
            aria-label="設定を開く"
          >
            <img
              src="../components/ui/gear-fill.svg"
              alt="設定"
              width="16"
              height="16"
            />
          </button>
        </div>
        <!-- 設定パネル -->
        <div class="collapse" id="collapseExample">
          <div
            style="
              border-radius: 8px;
              border: 2px solid #aaa;
              padding: 12px;
              font-size: 0.9rem;
            "
          >
            <div
              style="
                display: flex;
                gap: 8px;
                align-items: center;
                margin-bottom: 0.5rem;
              "
            >
              <h2 style="font-size: 1rem; margin: 0">設定</h2>
            </div>
            <p style="color: var(--muted-foreground)">
              以下の設定の変更するには、config.js を編集してください。
            </p>
            <div>
              <label for="hinichi-input">"お日にちがかかる..." を上書き:</label>
              <input
                type="text"
                style="width: 200px"
                data-fb-target=".ohinichi, .ohinichi-for-taishogai"
                id="ohinichi-input"
                data-fb-priority="1"
                placeholder="お日にちがかかる可能性案内"
                disabled
              />
            </div>
            <div>
              <label for="hinichi-input">日時のフォーマット:</label>
              <input
                type="text"
                style="width: 200px"
                id="datetime-format-input"
                disabled
              />
            </div>
          </div>
        </div>

        <!-- キーワード -->
        <!-- <div>
          <span class="text-sm" style="margin-right: 8px">頻出キーワード:</span>
          <button class="keyword-btn" data-keyword="浴室暖房乾燥機">
            浴室暖房乾燥機
          </button>
          <button
            class="keyword-btn"
            data-keyword="お客様がメーカーに直接修理依頼"
          >
            お客様がメーカーに直接修理依頼
          </button>
          <button class="keyword-btn" data-keyword="ユナイト非対応の照明">
            ユナイト非対応の照明
          </button>
        </div> -->

        <!-- Category Buttons -->
        <div class="flex gap-1 items-center">
          <span class="text-sm text-muted-foreground font-bold">カテゴリー</span>
          <div id="category-buttons" class="flex items-center gap-1"></div>
        </div>
        <!-- <div class="tabs-list" id="main-tabs" style="justify-content: center">
            <button class="tabs-trigger" data-tabs-value="受電">受電</button>
            <button class="tabs-trigger" data-tabs-value="CB">CB</button>
          </div> -->
      </div>
    </div>

    <div class="container bg-muted">
      <div
        id="result-count"
        style="color: var(--muted-foreground); font-size: 0.875rem"
        role="status"
        aria-live="polite"
      ></div>

      <div id="items-container" class="flex flex-col gap-3 mt-2">
        <div
          class="search-item card"
          data-title="有償警告"
          data-aliases="ゆうしょうけいこく"
          data-category="受電"
          data-created-at="2026-02-01"
        >
          <label id="is-mitsubishi-label">
            <input
              type="checkbox"
              id="is-mitsubishi-checkbox"
              data-fb-target=".ohinichi"
              data-true-value="通常よりお日にちがかかる可能性案内"
              data-fb-priority="2"
            />
            三菱
          </label>

          <div style="display: flex; gap: 8px">
            <div class="copyable">
              ・有償警告案内<span class="yusho-keikoku">未</span><br />
              ・<span class="ohinichi">お日にちがかかる可能性案内</span
              ><span class="yusho-keikoku">未</span>
            </div>
            <div class="copyable">
              ・有償警告案内済<br />
              ・<span class="ohinichi">お日にちがかかる可能性案内</span
              ><span>済</span>
            </div>
          </div>

          <div style="display: flex; gap: 8px">
            <div class="copyable">
              ・メーカー保証期間内の有償警告案内<span class="yusho-keikoku"
                >未</span
              ><br />
              ・<span class="ohinichi">お日にちがかかる可能性案内</span
              ><span class="yusho-keikoku">未</span>
            </div>

            <div class="copyable">
              ・メーカー保証期間内の有償警告案内済<br />
              ・<span class="ohinichi">お日にちがかかる可能性案内</span
              ><span>済</span>
            </div>
          </div>
        </div>

        <div
          class="search-item card"
          data-title="保証対象外部位"
          data-aliases="ほしょうたいしょうがいぶい"
          data-category="受電"
          data-created-at="2026-02-01"
        >
          <!-- <div class="card-title">保証対象外部位</div> -->
          <div class="talk">
            今回の症状は、保証対象外のため、有償になります。費用については、メーカーに直接ご相談ください。
          </div>

          <hr />

          <div>
            <!-- <h3>備考</h3>
            <label style="margin-right: 12px">
              <input
                type="checkbox"
                id="taishogai-status-checkbox"
                data-fb-target=".taishogai-status"
                data-true-value="済"
                data-false-value="未"
              />
              済
            </label> -->
            <div style="display: flex; gap: 8px">
              <div class="copyable">
                ・保証対象外部位案内<span class="taishogai-status">未</span
                ><br />
                ・<span class="ohinichi-for-taishogai"></span
                ><span class="taishogai-status">未</span>
              </div>

              <div class="copyable">
                ・保証対象外部位案内<span class="taishogai-status">済</span
                ><br />
                ・<span class="ohinichi-for-taishogai"></span
                ><span class="taishogai-status">済</span>
              </div>
            </div>
          </div>

          <hr />

          <div>
            <h3 class="mb-1">伝達事項/申し送り事項</h3>
            <div class="copyable">
              対象外部位（■）と思われるため、修理のお取次ぎお願いします。
            </div>
          </div>
        </div>

        <div
          class="search-item card"
          data-title="留守番電話への吹き込み希望"
          data-aliases="留守電, るすでん, るすばんでんわ, ふきこみ"
          data-category="受電"
          data-created-at="2026-02-01"
        >
          <h3>伝達事項/申し送り事項</h3>
          <div class="copyable">
            不出の場合は、留守番電話に吹き込んでほしいとのご希望がございました。
          </div>
        </div>

        <div
          class="search-item card"
          data-title="浴室暖房乾燥機"
          data-category="受電"
          data-created-at="2026-02-01"
        >
          <!-- <div class="card-title">浴室暖房乾燥機</div> -->
          <h3>トーク(→販売店)</h3>
          <div class="talk">
            <p>
              先程、お客様から浴室暖房乾燥機の修理依頼のお電話が入りまして、その浴室暖房乾燥機が10年保証に入っているかの確認のために、お電話をさせていただきました。
            </p>
            <p>お客様情報をお伝えしてもよろしいでしょうか？</p>
          </div>
          <h3>備考</h3>
          <div class="copyable">
            店舗より、製品が10年保証に入っていることを確認済み。
          </div>
          <h3>その他</h3>
          <h4>型番の例</h4>
          <ul>
            <li>MAX UFD-111A</li>
            <li>TOTO TYB3111GAS 三乾王</li>
          </ul>
          <div class="hidden">よくだん, よくしつだんぼうかんそうき</div>
        </div>

        <div
          class="search-item card"
          data-title="お客様が直接メーカーに修理依頼をした"
          data-aliases="めーかー, ちょくせつ, しゅうりいらい"
          data-category="受電"
          data-created-at="2026-02-01"
        >
          <h3>訪問前/訪問中</h3>
          <div class="talk">
            恐れ入りますが、当窓口を通していない修理は10年保証対象外でございます。
            お手数をおかけいたしますが、お客様が直接メーカーに依頼した修理は、お客様ご自身でキャンセルしていただきますようお願いいたします。
            そして、こちらのお電話で、10年保証対象の修理依頼を受け付けます。
          </div>
          <h4>備考:</h4>
          <div class="copyable">
            直接メーカーに依頼した修理をお客様ご自身でキャンセルしていただくよう案内。<br />
            当窓口で10年保証対象の修理依頼を承る。
          </div>
          <h3>訪問後</h3>
          <div class="talk">
            恐れ入りますが、当窓口を通していない修理は10年保証対象外でございます。
          </div>
        </div>

        <div
          class="search-item card"
          data-title="エアコンの修理依頼"
          data-aliases="えあこん"
          data-category="受電"
          data-created-at="2026-02-01"
        >
          <div class="talk">
            こちらの窓口はリフォーム製品の10年保証の窓口のため、ご購入店舗へお問い合わせください。
          </div>
          <h4>備考:</h4>
          <div class="copyable">購入店舗へ問い合わせていただくよう案内。</div>
        </div>

        <div
          class="search-item card"
          data-title="IHクッキングヒーター 天板にひび（割れ）"
          data-category="受電"
          data-created-at="2026-02-01"
        >
          <!-- <div class="card-title">IHクッキングヒーター 天板にひび（割れ）</div> -->
          <div>保証対象外部位</div>
        </div>

        <div
          class="search-item card"
          data-title="連絡希望時間/訪問希望日"
          data-aliases="れんらく, ほうもん"
          data-category="受電"
          data-created-at="2026-02-01"
        >
          <h3>申し送り事項</h3>
          <div class="copyable">連絡は■～■時、■時以降ご希望です。</div>
          <div class="copyable">訪問は■/■ご希望です。</div>
        </div>

        <div
          class="search-item card"
          data-title="販売店連携"
          data-category="受電"
          data-created-at="2026-02-01"
        >
          <h3>トーク (→お客様)</h3>
          <div class="talk">
            <p>
              今回の症状は、製品ではなく施工の問題の可能性もあるため、販売店と相談させていただきます。もし製品ではなく、施工の問題の可能性が高いと判断した場合は、販売店から連絡いたします。
            </p>
            <p>
              メーカーの修理になる可能性もあるため、10年保証の案内と、メーカーの修理の流れについて、ご案内させていただきます。
            </p>
            <p>[10年保証のトークスクリプト]</p>
          </div>

          <h3>トーク (→販売店)</h3>
          <div class="talk">
            先程、お客様から修理依頼のお電話をいただきまして、その故障の問題が施工と製品のどちらにあるのか、私共の窓口では判断できないため、ご相談させていただきたく、お電話いたしました。
          </div>
          <div></div>

          <div class="box flex flex-col gap-2">
            <div class="font-bold">メーカー修理の場合</div>

            <h3>備考</h3>
            <div class="copyable">
              <div>
                <span class="clock"></span> CC<span class="operator-name"
                  >■</span
                >
              </div>
              <div>対応者: ■店/■様/■</div>
              <div>メーカー修理をご希望。修理依頼を承る。</div>
            </div>

            <h3>申し送り事項</h3>
            <div class="copyable">
              販売店よりメーカー修理のご希望がございました。
            </div>
          </div>
          <div class="hidden">はんばいてんれんけい</div>
        </div>

        <div
          class="search-item card"
          data-title="販売店連携（メーカー修理不可）"
          data-category="受電"
          data-created-at="2026-02-01"
        >
          <div>給湯器（エコキュートなど）の外部配管/...</div>
          <h3>トーク (→お客様)</h3>
          <div class="talk">
            今回の症状は、製品ではなく施工の問題のため、販売店からご連絡いたします。
          </div>

          <h3>トーク (→販売店)</h3>
          <div class="talk">
            先程、お客様から■の修理依頼のお電話をいただきまして、故障の内容が施工のため、販売店様でご対応いただきたく、お電話いたしました。
          </div>
          <div></div>
          <div class="hidden">はんばいてんれんけい</div>
        </div>

        <div
          class="search-item card"
          data-title="ユナイト非対応の製品（照明など）"
          data-aliases="スワン, すわん, しょうめい, 照明, ゆないと"
          data-category="受電"
          data-created-at="2026-02-01"
        >
          <div>スワン、ｘｘ、ｘｘ、はユナイト非対応。家電119へ依頼。</div>
          <h3>トーク (→お客様)</h3>
          <div class="talk">
            担当部署（家電の119番）から折り返しご連絡いたします。
          </div>

          <h3>トーク (→家電119)</h3>
          <div class="talk">
            先程、お客様から■の修理依頼のお電話が入りまして、こちらの製品の場合、エディオン本部からの指示により、家電の119番様でのご対応をお願いしております。
          </div>

          <h3>備考</h3>
          <div class="copyable">
            <div>
              <span class="clock"></span> 架電 CC<span class="operator-name"
                >■</span
              >
            </div>
            <div>対応者: 家電119/■様/■</div>
            <div>
              ユナイト非対応の製品のため、家電119へ連携。ご対応をお願いし、了承をいただく。
            </div>
          </div>
        </div>

        <div
          class="search-item card"
          data-title="案内ステータス"
          data-category="受電"
          data-created-at="2026-02-01"
        >
          <table class="copyable-table">
            <tr>
              <th></th>
              <th>未</th>
              <th>済</th>
            </tr>
            <tr>
              <th>有償警告案内</th>
              <td>有/未</td>
              <td>有/済</td>
            </tr>
            <tr>
              <th>メーカー保証期間内</th>
              <td>メ/未</td>
              <td>メ/済</td>
            </tr>
            <tr>
              <th>保証対象外部位</th>
              <td>外/未</td>
              <td>外/済</td>
            </tr>
          </table>
        </div>

        <div
          class="search-item card"
          data-title="CB: 修理依頼OK"
          data-category="CB"
          data-created-at="2026-02-01"
        >
          <div class="card-content">
            <div style="display: flex; gap: 4px; align-items: center">
              <span>案内: </span>
              <div class="radio-pills">
                <label>
                  <input
                    type="radio"
                    name="outbound-annai"
                    value="有償警告案内済"
                    data-fb-target="#outbound-annai"
                    checked
                  />有償警告
                </label>
                <label>
                  <input
                    type="radio"
                    name="outbound-annai"
                    value="メーカー保証期間内の有償警告案内済"
                    data-fb-target="#outbound-annai"
                  />メーカー保証期間内
                </label>
                <label>
                  <input
                    type="radio"
                    name="outbound-annai"
                    value="保証対象外部位案内済"
                    data-fb-target="#outbound-annai"
                  />保証対象外
                </label>
              </div>
            </div>

            <div style="display: flex; gap: 4px; align-items: center">
              <span>故障内容: </span>
              <div class="radio-pills">
                <label>
                  <input
                    type="radio"
                    name="outbound-koshonaiyo"
                    value="故障内容一致を確認。"
                    data-fb-target="#outbound-koshonaiyo"
                    checked
                  />一致
                </label>
                <label>
                  <input
                    type="radio"
                    name="outbound-koshonaiyo"
                    data-fb-target="#outbound-koshonaiyo"
                    value="故障内容追記:<br>■"
                  />追記
                </label>
                <label>
                  <input
                    type="radio"
                    name="outbound-koshonaiyo"
                    data-fb-target="#outbound-koshonaiyo"
                    value="故障内容変更:<br>■<br>↓<br>■"
                  />変更
                </label>
              </div>
            </div>

            <div>
              <label class="flex items-center w-fit">
                <input
                  type="checkbox"
                  data-fb-target="#cb-ok-taiosha"
                  data-fb-true-value="対応者: ■"
                  data-fb-false-value="[hidden]"
                />
                対応者が契約者ではない
              </label>
            </div>

            <div class="copyable">
              <div>
                <span class="clock"></span> 架電 CC<span class="operator-name"
                  >■</span
                >
              </div>
              <div id="cb-ok-taiosha">対応者: ■</div>
              <div>・<span id="outbound-annai"></span></div>
              <div>・<span class="ohinichi"></span>済</div>
              <div id="outbound-koshonaiyo"></div>
            </div>
          </div>
        </div>

        <div
          class="search-item card"
          data-title="CB: 不出"
          data-category="CB"
          data-created-at="2026-02-01"
        >
          <!-- <div class="card-title">CB: 不出</div> -->
          <div class="card-content">
            <div class="radio-pills">
              <label
                ><input
                  type="radio"
                  name="fude-kaisu"
                  value="1回目"
                  data-fb-target="#fude-kaisu"
                  checked
                />
                1回目</label
              >
              <label
                ><input
                  type="radio"
                  name="fude-kaisu"
                  value="2回目"
                  data-fb-target="#fude-kaisu"
                />
                2回目</label
              >
              <label
                ><input
                  type="radio"
                  name="fude-kaisu"
                  value="3回目"
                  data-fb-target="#fude-kaisu"
                />
                3回目</label
              >
            </div>
            <div
              style="
                display: flex;
                gap: 4px;
                align-items: center;
                margin-bottom: 8px;
              "
            >
              <select
                id="fude-type-select"
                data-fb-target="#fude-type"
                data-fb-priority="2"
              >
                <option value="留守電吹き込み済み">留守電吹き込み済み</option>
                <option value="留守電">留守電</option>
                <option value="コール音">コール音</option>
                <option value="話中">話中</option>
                <option value="「近くにおりません」アナウンス">
                  「近くにおりません」アナウンス
                </option>
              </select>
              <input
                type="text"
                id="fude-type-override-input"
                data-fb-target="#fude-type"
                data-fb-priority="1"
                data-fb-ignore-empty="true"
                placeholder="自由に入力"
                data-clearable
              />
            </div>

            <div class="copyable">
              <div>
                <span id="fude-kaisu"></span>
                <span class="clock"></span> 架電 CC<span class="operator-name"
                  >■</span
                >
              </div>
              <div id="fude-type"></div>
            </div>
          </div>
        </div>

        <div
          class="search-item card"
          data-title="CB: 販売店戻し"
          data-aliases="はんばいてんもどし"
          data-category="CB"
          data-created-at="2026-02-01"
        >
          <div class="card-content">
            <div class="copyable">
              <div>
                <span class="clock"></span> 架電 CC<span class="operator-name"
                  >■</span
                >
              </div>
              <div>対応者: ■店/■様/■</div>
              <div>
                お客様が当CCからの電話にお出にならず、修理の手配を進められない旨をお伝え。
                フリーダイヤルの電話に出ていただくか、お客様から当CCへ折り返しご連絡いただくようお伝えいただき、その結果を折り返していただくようお願いし、了承を得る。
              </div>
            </div>
          </div>
        </div>

        <!-- この階層にデータを追加 -->
      </div>

      <!-- 該当するデータがない -->
      <div id="no-results" class="empty-state" style="display: none">
        <div>データがありません</div>
      </div>

      <!-- データがない -->
      <div id="empty-state" class="empty-state" style="display: none">
        <div>データを追加してください。</div>
        <a href="./help.html#how-to-add-data" target="_blank"
          >データを追加する方法</a
        >
      </div>
    </div>

    <!-- Scripts -->
    <!-- 設定ファイル -->
    <script src="./config.js"></script>
    <!-- Day.js (日時ライブラリ) -->
    <script src="../vendor/dayjs.min.js"></script>
    <!-- Bootstrap (UIフレームワーク) -->
    <script src="../vendor/bootstrap/bootstrap.bundle.min.js"></script>
    <!-- DOM操作ユーティリティ -->
    <script src="../utils/dom-utils.js"></script>
    <!-- ワンクリックでコピー -->
    <script src="../lib/copy-handler/index.js"></script>
    <!-- 日時表示 -->
    <script src="../lib/clock/index.js"></script>
    <!-- データ検索 -->
    <script src="../lib/search-filter/index.js"></script>
    <!-- フォームのイベント発生時にUIを自動更新 -->
    <script src="../lib/form-binder/index.js"></script>
    <!-- テキストボックスにクリアボタンを追加 -->
    <script src="../lib/input-clear/index.js"></script>
    <!-- タブ -->
    <!-- <script src="../lib/tabs/index.js"></script> -->

    <script>
      let isAdmin = false;
      /**
       * data-title属性を持つ要素にcard-titleを自動生成
       */
      function initItemUI() {
        document.querySelectorAll("[data-title]").forEach((element) => {
          const title = element.dataset.title;
          if (title) {
            const existingTitle = element.querySelector(".card-title");
            if (!existingTitle) {
              const cardTitle = document.createElement("div");
              cardTitle.className = "card-title";
              cardTitle.textContent = title;
              element.insertBefore(cardTitle, element.firstChild);
            }
          }
        });
      }

      /**
       * CONFIG.categoriesを使って、カテゴリーボタンを生成
       */
      function generateCategoryButtons() {
        const container = document.getElementById("category-buttons");
        if (!container) return;

        // 新しいフラグメントを作成
        const fragment = document.createDocumentFragment();

        // CONFIG.categoriesの各カテゴリーに対してボタンを生成
        CONFIG.categories.forEach((category) => {
          const button = document.createElement("button");
          button.className = "tab-pill pushable";

          // "全て:all" のような形式の場合、ラベルとvalueを分割
          if (category.includes(":")) {
            const [label, value] = category.split(":");
            button.textContent = label;
            button.dataset.targetCategory = value;
          } else {
            button.textContent = category;
            button.dataset.targetCategory = category;
          }

          fragment.appendChild(button);
        });

        // 要素全体を置き換え
        container.replaceChildren(fragment);
      }

      /**
       * UI要素を初期化
       */
      function initUI() {
        initItemUI();
        generateCategoryButtons();
        // 管理者用の表示
        const params = new URLSearchParams(location.search);
        isAdmin = params.has("admin");
        if (isAdmin) {
          const elem = document.getElementById("help-link");
          elem.style.display = "block";
        }

        // オペレーター名
        const initialOperatorName = "■";
        document
          .getElementById("operator-name-input")
          .addEventListener("input", (event) => {
            let newValue = event.target.value.trim();
            if (newValue === "") {
              // #operator-name-inputが空の時は、#operator-name-inputのbackground-colorを赤にする。
              // input.style.backgroundColor = "#ffcccc";
              newValue = initialOperatorName;
            } else {
              // input.style.backgroundColor = "";
            }
            document.querySelectorAll(".operator-name").forEach((el) => {
              el.textContent = newValue;
            });
          });
        dispatchEventBySelector("#operator-name-input", "input"); // 初期化

        // 日時フォーマット
        document.getElementById("datetime-format-input").value =
          CONFIG.datetimeFormat;
      }

      // DomUtilsから関数を取得
      const { dispatchEventBySelector } = window.DomUtils;

      // UI初期化
      initUI();

      // ライブラリを初期化
      // InputClearを初期化
      new InputClear();
      // CopyHandlerを初期化
      new CopyHandler({
        copyIconColor: "var(--accent)", // コピーアイコンの色
        flashColor: "color-mix(in srgb, var(--accent) 30%, transparent)", // コピー成功時のハイライト色
        // showCopyIcon: false,  // コピーアイコンを非表示
        includeTh: false, // th要素をコピー対象外
      });
      // SearchFilterを初期化
      const searchFilter = new SearchFilter();

      /**
       * カテゴリフィルターボタンのイベントリスナーを設定
       */
      function initCategoryFilters() {
        document
          .querySelectorAll("[data-target-category]")
          .forEach((button) => {
            button.addEventListener("click", (e) => {
              const category = e.currentTarget.dataset.targetCategory;

              if (category === "all") {
                searchFilter.clearFilters();
              } else {
                searchFilter.setFilter("category", category);
              }

              document
                .querySelectorAll("[data-target-category]")
                .forEach((btn) => {
                  btn.classList.remove("active");
                });
              e.currentTarget.classList.add("active");
            });
          });

        // 初期状態でデフォルトカテゴリーのフィルターを適用
        const defaultCategory = CONFIG.defaultCategory;
        if (!defaultCategory) {
          console.warn("CONFIG.defaultCategory が設定されていません");
          return;
        }

        const defaultButton = document.querySelector(
          `[data-target-category="${defaultCategory}"]`,
        );
        if (defaultButton) {
          defaultButton.classList.add("active");
          searchFilter.setFilter("category", defaultCategory);
        } else {
          console.error(
            `デフォルトカテゴリー "${defaultCategory}" に対応するボタンが見つかりません。CONFIG.categories に "${defaultCategory}" が含まれているか確認してください。`,
          );
        }
      }

      initCategoryFilters();

      // キーワードボタンのイベントリスナーを設定
      function initKeywordButtons() {
        document.querySelectorAll(".keyword-btn").forEach((button) => {
          button.addEventListener("click", (e) => {
            const keyword = e.target.dataset.keyword;
            const searchInput = document.getElementById("search-input");
            searchInput.value = keyword;
            searchInput.dispatchEvent(new Event("input", { bubbles: true }));
            searchInput.focus();
          });
        });
      }

      initKeywordButtons();

      // 日時表示を初期化
      new Clock({
        format: CONFIG.datetimeFormat,
        // format: "YYYY/MM/DD HH:mm:ss"
      });

      // FormBinderを初期化
      new FormBinder();

      // 不出の種類のセレクトボックスのvalueが変わった時、不出の種類の上書きテキストボックスのvalueをクリア
      document
        .getElementById("fude-type-select")
        .addEventListener("change", (e) => {
          const overrideInput = document.getElementById(
            "fude-type-override-input",
          );
          if (overrideInput.value !== "") {
            overrideInput.value = "";
            const event = new Event("input", { bubbles: true });
            overrideInput.dispatchEvent(event);
          }
        });

      function updateOhinichiUI() {
        const text = CONFIG.ohinichiText || config.defaultOhinichiText;
        document
          .querySelectorAll(".ohinichi, .ohinichi-for-taishogai")
          .forEach((element) => {
            element.textContent = text;
          });
      }

      function updateIsMitsubishiUI() {
        const isMitsubishiLabel = document.getElementById(
          "is-mitsubishi-label",
        );

        if (CONFIG.ohinichiText) {
          isMitsubishiLabel.style.display = "none";
          return;
        } else {
          isMitsubishiLabel.style.display = "";
        }
      }

      function init() {
        // タブを初期化
        // const tabs = new Tabs({
        //   tabsList: "#main-tabs", // TabsList
        //   defaultValue: "受電", // アクティブなタブのデフォルト値
        //   variant: "pills", // タブのスタイル: 'underline' または 'pills'
        //   activeBgColor: "var(--accent)", // アクティブなタブの背景色
        //   activeBorderColor: "var(--accent)", // アクティブなタブのborderの色
        //   // activeColor: "var(--accent)", // アクティブなタブのテキストの色
        //   // onValueChange: (value, previousValue) => {
        //   //   console.log(`Value changed: ${previousValue} → ${value}`);
        //   // },
        // });

        //
        updateOhinichiUI();
        updateIsMitsubishiUI();

        document.getElementById("ohinichi-input").value = CONFIG.ohinichiText;
        // dispatchEventBySelector('input[id="ohinichi-input"]', "input");
      }
      init();
    </script>
  </body>
</html>
